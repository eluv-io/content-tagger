# Tag Containers

This module abstracts away all runtime details of **Podman** into a consistent interface provided by the `TagContainer` class.  
It also handles conversion of raw JSON outputs—generated by containerized models at runtime—into structured internal representations used by other modules like the tagger.

---

## Important Entities

### **TagContainer**

The main class providing a unified interface for running tagging containers.

**Stores:**
- **Image name** – the container image to run.  
- **Media directory** – where the model reads media from (mounted at startup).  
- **Output directory** – where the model writes its tag outputs.  
- **Runtime arguments** – model-specific parameters such as `fps` or `threshold`.  
- **Required resources** – a system-agnostic struct describing what hardware the model needs (used by the scheduler). 

**Methods:**
- `start()` – starts the container.  
- `tags()` – reads the tag output directory and formats the data into internal tag structs. 

---

### **LiveTagContainer**

An implementation of `TagContainer` that supports **live mode**, maintaining an open UNIX domain socket for dynamic media input.

**Additional Methods:**
- `add_media()` – sends new media files for tagging.  
- `send_eof()` – schedules the container to exit after processing the final batch.

This is the default `TagContainer` type for live tagging workflows.

---

### **ContainerRegistry**

Maintains the catalog of all supported models (containers) that the tagger may execute.

**Responsibilities:**
- Maps short handles (e.g., `"asr"`) to model containers.  
- Stores metadata such as resource requirements and default runtime parameters.  
- Loads from `config.yml` today, but ideally should fetch from a centralized source (e.g., Google Cloud or the Fabric).

> **Note:** The name `ContainerRegistry` is somewhat overloaded—`ContainerManager` may be a clearer alternative.
